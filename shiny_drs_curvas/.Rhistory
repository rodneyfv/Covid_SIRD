mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
print(p)
variavel0
fct_relevel()
?fct_relevel()
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
fct_relevel(classe_urb,"alto","moderado","baixo") %>%
ggplot(aes(x=Data, y=curva, color=classe_urb)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
fct_relevel(classe_urb,"alto","moderado","baixo") %>%
mutate_(curva = curva0) %>%
group_by(Data,classe_urb) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
print(p)
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para as RSs no estado filtrado
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
print(p)
variavel0=="classe_urb"
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
#mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate(variavel = ifelse(variavel0=="classe_urb",fct_relevel(classe_urb,"alto","moderado","baixo"),variavel0)) %>%
mutate_(curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
#mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate(variavel = ifelse(variavel0=="classe_urb",fct_relevel(classe_urb,"alto","moderado","baixo"),variavel0)) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
print(p)
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
#mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate(variavel = ifelse(variavel0=="classe_urb",fct_relevel(classe_urb,"alto","moderado","baixo"),variavel0)) %>%
mutate_(curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
#mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate(variavel = ifelse(variavel0=="classe_urb",fct_relevel(classe_urb,"alto","moderado","baixo"),variavel0)) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
print(p)
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
print(p)
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
#mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
{
if(variavel0=="classe_urb"){
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo"))
}
} %>%
mutate_(curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
print(p)
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para as RSs no estado filtrado
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
# se a variável for classe de urbanização, precisamos
# reordenar os fatares para aparecerem na ordem certa na legenda
if(variavel0=="classe_urb"){
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
}else{
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
}
print(p)
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para o Brasil
tmp1 <- estim_drs_df %>% mutate_(curva = curva0) %>%
group_by(Data) %>% dplyr::summarize(curva = mean(curva))
if(variavel0=="classe_urb"){
tmp2 <- estim_drs_df %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>% group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
}else{
tmp2 <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
}
print(p)
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para o Brasil
tmp1 <- estim_drs_df %>% mutate_(curva = curva0) %>%
group_by(Data) %>% dplyr::summarize(curva = mean(curva))
if(variavel0=="classe_urb"){
tmp2 <- estim_drs_df %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>% group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
}else{
tmp2 <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
}
print(p)
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para o Brasil
tmp1 <- estim_drs_df %>% mutate_(curva = curva0) %>%
group_by(Data) %>% dplyr::summarize(curva = mean(curva))
if(variavel0=="classe_urb"){
tmp2 <- estim_drs_df %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>% group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
}else{
tmp2 <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
}
print(p)
vec_curva <- c("R_e","beta_t","mu_t","nu_t")
vec_variavel <- c("drs_idhm","idhm_A_nA","classe_urb","idhm_A_urb")
vec_estado <- unique(estim_drs_df$Estado)
for(curva0 in vec_curva){
for(variavel0 in vec_variavel){
for(estado0 in vec_estado){
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para as RSs no estado filtrado
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
# se a variável for classe de urbanização, precisamos
# reordenar os fatares para aparecerem na ordem certa na legenda
if(variavel0=="classe_urb"){
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
}else{
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
}
# salvando a imagem na pasta
png(file=paste(paste(estado0,curva0,variavel0,sep = "_"),".png",sep =""))
print(p)
dev.off()
}
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para o Brasil
tmp1 <- estim_drs_df %>% mutate_(curva = curva0) %>%
group_by(Data) %>% dplyr::summarize(curva = mean(curva))
if(variavel0=="classe_urb"){
tmp2 <- estim_drs_df %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>% group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
}else{
tmp2 <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
}
png(file=paste(paste("Brasil",curva0,variavel0,sep = "_"),".png",sep =""))
print(p)
dev.off()
}
}
warnings()
variavel0 = "classe_urb"
estado0
vec_curva <- c("R_e","beta_t","mu_t","nu_t")
vec_variavel <- c("drs_idhm","idhm_A_nA","classe_urb","idhm_A_urb")
vec_estado <- unique(estim_drs_df$Estado)
for(curva0 in vec_curva){
for(variavel0 in vec_variavel){
for(estado0 in vec_estado){
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para as RSs no estado filtrado
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
# se a variável for classe de urbanização, precisamos
# reordenar os fatares para aparecerem na ordem certa na legenda
if(variavel0=="classe_urb"){
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
}else{
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
}
# salvando a imagem na pasta
png(file=paste(paste(estado0,curva0,variavel0,sep = "_"),".png",sep =""))
print(p)
dev.off()
}
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para o Brasil
tmp1 <- estim_drs_df %>% mutate_(curva = curva0) %>%
group_by(Data) %>% dplyr::summarize(curva = mean(curva))
if(variavel0=="classe_urb"){
tmp2 <- estim_drs_df %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
mutate_(curva = curva0) %>% group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(curva = curva0) %>%
mutate(variavel = fct_relevel(classe_urb,"alto","moderado","baixo")) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
}else{
tmp2 <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
}
png(file=paste(paste("Brasil",curva0,variavel0,sep = "_"),".png",sep =""))
print(p)
dev.off()
}
}
