# fatores (A,nA)x(alto,moderado,baixo)
estim_drs_df <- estim_drs_df %>%
mutate(idhm_A_nA = factor(ifelse(drs_idhm %in% c("B","C","D"), "BCD", "A"))) %>%
mutate(idhm_A_urb = factor(paste(idhm_A_nA, classe_urb)))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot( aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=tmp2, alpha = 1, size = 2, linetype=rep(1,21)) +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot( aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=tmp2, alpha = 1, size = 2, linetype="solid") +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot( aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=tmp2, alpha = 1, size = 2) +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot( aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=tmp2, alpha = 1, size = 2) +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
#variavel0 <- c("classe_urb","drs_idhm")
variavel0 <- "classe_urb"
#curva0 <- c("R_e","beta_t","mu_t","nu_t")
curva0 <- "R_e"
estado0 <- "SAO PAULO"
# curvas com médias dos grupos
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot( aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=tmp2, alpha = 1, size = 2) +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot( aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=tmp2, alpha = 1, size = 2,linetype="solid") +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot( aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=tmp2, alpha = 1, size = 2,linetype=rep("solid",21)) +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot( aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=tmp2, alpha = 1, size = 2) +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(subset(Data<"2020-06-01") aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=tmp2, alpha = 1, size = 2)
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(subset(Data<"2020-06-01") aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=tmp2, alpha = 1, size = 2) +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
tmp <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0)
p <- tmp %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2) +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=tmp1, alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dotted") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
p
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="dashed") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
p
p <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
p
tmp1 <- estim_drs_df %>% mutate_(curva = curva0) %>%
group_by(Data) %>% dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>% dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
p
vec_estado <- unique(estim_drs_df$Estado)
class(vec_estado)
length(vec_estado)
vec_estado[1:5]
fct_relevel()
?fct_relevel
vec_curva <- c("R_e","beta_t","mu_t","nu_t")
vec_variavel <- c("drs_idhm","idhm_A_nA","classe_urb","idhm_A_urb")
vec_estado <- unique(estim_drs_df$Estado)
curva0 = "R_e"
variavel0 = "classe_urb"
estado0 = "ACRE"
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para as RSs no estado filtrado
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
p
estim_drs_df %>% filter(Estado=="ACRE") %>% select(classe_urb) %>% group_by(classe_urb) %>% dplyr::summarise(n = n())
estim_drs_df %>% filter(Estado=="SAO PAULO") %>% select(classe_urb) %>% group_by(classe_urb) %>% dplyr::summarise(n = n())
estim_drs_df %>% filter(Estado=="CEARA") %>% select(classe_urb) %>% group_by(classe_urb) %>% dplyr::summarise(n = n())
estado0 = "CEARA"
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para as RSs no estado filtrado
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
p
p <- estim_drs_df %>% filter(Estado==estado0) %>%
fct_relevel(classe_urb,"alto","moderado","baixo") %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
variavel0=="classe_urb"
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = ifelse(variavel0=="classe_urb",fct_relevel(classe_urb,"alto","moderado","baixo"),variavel0) , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = ifelse(variavel0=="classe_urb",fct_relevel(classe_urb,"alto","moderado","baixo"),variavel0) , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
p
paste(estado0,curva0,variavel0)
gsub(" ","_",paste(estado0,curva0,variavel0))
paste(gsub(" ","_",paste(estado0,curva0,variavel0)),".png")
paste(estado0,curva0,variavel0,collapse = NULL)
paste(estado0,curva0,variavel0,collapse = "")
paste(estado0,curva0,variavel0,sep = "")
paste(estado0,curva0,variavel0,sep = "_")
paste(paste(estado0,curva0,variavel0,sep = "_"),".png"),sep="")
paste(estado0,curva0,variavel0,sep = "_"),".png")
paste(estado0,curva0,variavel0,sep = "_")
paste(paste(estado0,curva0,variavel0,sep = "_"),".png",sep ="")
paste(paste(estado0,curva0,variavel0,sep = "_"),".png",sep ="")
paste(paste(estado0,curva0,variavel0,sep = "_"),".png",sep ="")
png(file=paste(paste(estado0,curva0,variavel0,sep = "_"),".png",sep =""))
p
dev.off()
paste(paste("Brasil",curva0,variavel0,sep = "_"),".png",sep ="")
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para o Brasil
tmp1 <- estim_drs_df %>% mutate_(curva = curva0) %>%
group_by(Data) %>% dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>% dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
png(file=paste(paste("Brasil",curva0,variavel0,sep = "_"),".png",sep =""))
p
dev.off()
vec_curva <- c("R_e","beta_t","mu_t","nu_t")
vec_variavel <- c("drs_idhm","idhm_A_nA","classe_urb","idhm_A_urb")
vec_estado <- unique(estim_drs_df$Estado)
for(curva0 in vec_curva){
for(variavel0 in vec_variavel){
for(estado0 in vec_estado){
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para as RSs no estado filtrado
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
png(file=paste(paste(estado0,curva0,variavel0,sep = "_"),".png",sep =""))
p
dev.off()
}
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para o Brasil
tmp1 <- estim_drs_df %>% mutate_(curva = curva0) %>%
group_by(Data) %>% dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>% dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
png(file=paste(paste("Brasil",curva0,variavel0,sep = "_"),".png",sep =""))
p
dev.off()
}
}
p
print(p)
vec_curva <- c("R_e","beta_t","mu_t","nu_t")
vec_variavel <- c("drs_idhm","idhm_A_nA","classe_urb","idhm_A_urb")
vec_estado <- unique(estim_drs_df$Estado)
for(curva0 in vec_curva){
for(variavel0 in vec_variavel){
for(estado0 in vec_estado){
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para as RSs no estado filtrado
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
# geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
png(file=paste(paste(estado0,curva0,variavel0,sep = "_"),".png",sep =""))
print(p)
dev.off()
}
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para o Brasil
tmp1 <- estim_drs_df %>% mutate_(curva = curva0) %>%
group_by(Data) %>% dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>% dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
#  geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
png(file=paste(paste("Brasil",curva0,variavel0,sep = "_"),".png",sep =""))
print(p)
dev.off()
}
}
28*15*4
28*4*4
for(curva0 in vec_curva){
for(variavel0 in vec_variavel){
for(estado0 in vec_estado){
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para as RSs no estado filtrado
tmp1 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(curva = curva0) %>%
group_by(Data) %>%
dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>%
dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>% filter(Estado==estado0) %>%
mutate_(variavel = variavel0 , curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste(estado0,":",curva0))
png(file=paste(paste(estado0,curva0,variavel0,sep = "_"),".png",sep =""))
print(p)
dev.off()
}
# curvas com médias dos grupos para duas semanas em linha contínua
# e para a última semana em pontilhado para o Brasil
tmp1 <- estim_drs_df %>% mutate_(curva = curva0) %>%
group_by(Data) %>% dplyr::summarize(curva = mean(curva))
tmp2 <- estim_drs_df %>% mutate_(variavel = variavel0, curva = curva0) %>%
group_by(Data,variavel) %>% dplyr::summarize(curva = mean(curva))
p <- estim_drs_df %>%
mutate_(variavel = variavel0, curva = curva0) %>%
ggplot(aes(x=Data, y=curva, color=variavel)) +
guides(colour = guide_legend(override.aes = list(alpha = 1,size=1))) +
geom_line(aes(group=codDRS), alpha = .5, size = .5,linetype="solid") +
geom_line(data=subset(tmp2,Data<"2020-06-01"), alpha = 1, size = 2,linetype="solid") +
geom_line(data=subset(tmp2,Data>="2020-06-01"), alpha = 1, size = 2,linetype="dotted") +
geom_line(data=subset(tmp1,Data<"2020-06-01"), alpha = 1, size = 2,color="black",linetype="solid") +
geom_line(data=subset(tmp1,Data>="2020-06-01"), alpha = 1, size = 2,color="black",linetype="dotted") +
ggtitle(paste("Brasil:",curva0))
png(file=paste(paste("Brasil",curva0,variavel0,sep = "_"),".png",sep =""))
print(p)
dev.off()
}
}
